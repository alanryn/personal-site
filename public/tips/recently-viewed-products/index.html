<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Alan Ryan | Shopify Dev</title>
    <meta
      name="google-site-verification"
      content="u5ezVva_l_Qr0dN5ht1p096Rs0pI1qg3oB053QGv9Jc"
    />
    
    <meta name="description" content="How to add a recently viewed products section to Shopify without using an app or jquery" />
    <meta name="author" content=""
    />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet"/>

    <link href="https://alanryan.dev/style.css" rel="stylesheet" /> 
 
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõí</text></svg>"
    />

    <meta name="generator" content="Hugo 0.80.0" />
    
    
  </head>
  <body>

<div class='wrapper'>
    <header>
      <nav class="nav"><h1 class="name"><a href="https://alanryan.dev">Alan Ryan</a></h1>

 
        <div class="theme-swapper-wrapper">
            <label>
                <input id="dark-toggle" class="swapper-checkbox" type="checkbox" aria-label="Switch between Light and Dark mode">
             </label>
        </div>
      </nav>
    </header>

    <main class="main">


<article class="post-single">
  <header class="post-header">
    <h1 class="post-title">Display Recently Viewed Products Without App or jQuery</h1>
    <div class="post-meta">
      Updated on February 22, 2022</div>
  </header>
  <div class="post-content"><p>This code will store the last 4 visited product pages in the browsers memory and display them as a section on the Product page. The steps below are for the Dawn theme.</p>
<p>Create a new section file, in this case called <code>recent-products.liquid</code>, and add the following code:</p>
<pre><code>&lt;div class=&quot;recently-viewed-wrapper page-width&quot;&gt;
    &lt;h2&gt;Recently Viewed&lt;/h2&gt;
    &lt;ul class=&quot;recently-viewed-grid&quot;&gt;
    &lt;!-- Recently viewed products will appear here --&gt;
    &lt;/ul&gt;
&lt;/div&gt;

&lt;script&gt;
function setRecentlyViewedProducts() {
  const productData = {
    productTitle: &quot;{{ product.title }}&quot;,
    productImg: &quot;{{ product.featured_media | img_url: '300x' }}&quot;,
    productPrice: &quot;{{ product.price | money }}&quot;,
    productUrl: &quot;{{ product.url }}&quot;,
    productImageAltText: &quot;{{product.featured_media.alt | escape }}&quot;
  };
  const productList = [];
  let jsonResp, jsonRespArr, jsonRespArrStr;
  const numberOfProducts = 8;
  productList.push(productData);
  const currProductPageTitle = productData.productTitle;
  const productDataString = JSON.stringify(productList);
  const localData = localStorage.getItem(&quot;recentlyViewedProduct&quot;);

  if (localData === null) {
    localStorage.setItem(&quot;recentlyViewedProduct&quot;, productDataString);
  } else if (localData) {
    const oldProductData = localStorage.getItem(&quot;recentlyViewedProduct&quot;);
    const countProductData = (oldProductData.match(/productTitle/g) || []).length;
    const sameProduct = oldProductData.includes(currProductPageTitle);
    if (countProductData &lt; numberOfProducts &amp;&amp; sameProduct == false) {
      jsonResp = JSON.parse(oldProductData);
      jsonRespArr = jsonResp.concat(productList);
      jsonRespArrStr = JSON.stringify(jsonRespArr);
      localStorage.setItem(&quot;recentlyViewedProduct&quot;, jsonRespArrStr);
    } else if (countProductData &gt;= numberOfProducts &amp;&amp; sameProduct == false) {
      jsonResp = JSON.parse(oldProductData);
      jsonResp.shift();
      jsonRespArr = jsonResp.concat(productList);
      jsonRespArr = JSON.stringify(jsonRespArr);
      localStorage.setItem(&quot;recentlyViewedProduct&quot;, jsonRespArr);
    }
  }
}

setRecentlyViewedProducts();
const localViewed = localStorage.recentlyViewedProduct;
function getRecentlyViewedProducts() {
  const productData = JSON.parse(localStorage.getItem(&quot;recentlyViewedProduct&quot;));
  const recentlyViewedHtml = [];
  productData.map(item =&gt; {
    recentlyViewedHtml.unshift(`
    &lt;li class=&quot;recently-viewed-grid-item&quot;&gt;
      &lt;a href=&quot;${item.productUrl}&quot;&gt; 
		&lt;img class=&quot;recently-viewed-img&quot; src='${item.productImg}' loading=&quot;lazy&quot; alt=&quot;${item.productImageAltText}&quot;/&gt;
      &lt;/a&gt;
       &lt;h3&gt;&lt;a class=&quot;recently-viewed-a&quot; href=&quot;${item.productUrl}&quot;&gt;${item.productTitle}&lt;/a&gt;&lt;/h3&gt;
       &lt;p&gt;${item.productPrice}&lt;/p&gt;
    &lt;/li&gt;
   `);
  });
  const newProductData = `${recentlyViewedHtml.join(&quot;&quot;)}`;
  const fullContent = document.getElementsByClassName(&quot;recently-viewed-grid&quot;);
  fullContent[0].innerHTML = newProductData;
}

document.addEventListener(&quot;DOMContentLoaded&quot;, function (event) {
  getRecentlyViewedProducts();
});

&lt;/script&gt;


&lt;style&gt;

.recently-viewed-wrapper{
  margin: 1rem auto;
}
.recently-viewed-img {
  width: 100%;
}
.recently-viewed-grid {
  display: grid;
  grid-gap: 1rem;
  grid-template-columns: repeat(auto-fill, minmax(min(100%, 260px), 1fr));
  list-style: none;
  margin:0; 
  padding: 0;
}    
.recently-viewed-grid-item {
  display: flex;
  flex-direction: column;
  text-align: center;
}
.recently-viewed-a {
  text-decoration: none;
  color: black;
}
    
&lt;/style&gt;

{% schema %}
  {
    &quot;name&quot;: &quot;Recent Products&quot;,
    &quot;settings&quot;: []
  }
{% endschema %}
</code></pre><p>Update the <code>product.json</code> file ( in the <code>Templates</code> folder ), to include the new <code>recent-products</code> section details:</p>
<pre><code>{
  &quot;sections&quot;: {
    &quot;main&quot;: {
      &quot;type&quot;: &quot;main-product&quot;,
      &quot;blocks&quot;: {
        &quot;vendor&quot;: {
          &quot;type&quot;: &quot;text&quot;,
          &quot;settings&quot;: {
            &quot;text&quot;: &quot;{{ product.vendor }}&quot;,
            &quot;text_style&quot;: &quot;uppercase&quot;
          }
        },
        &quot;title&quot;: {
          &quot;type&quot;: &quot;title&quot;,
          &quot;settings&quot;: {
          }
        },
        &quot;subtitle&quot;: {
          &quot;type&quot;: &quot;text&quot;,
          &quot;settings&quot;: {
            &quot;text&quot;: &quot;{{ product.metafields.descriptors.subtitle.value }}&quot;,
            &quot;text_style&quot;: &quot;subtitle&quot;
          }
        },
        &quot;price&quot;: {
          &quot;type&quot;: &quot;price&quot;,
          &quot;settings&quot;: {
          }
        },
        &quot;variant_picker&quot;: {
          &quot;type&quot;: &quot;variant_picker&quot;,
          &quot;settings&quot;: {
            &quot;picker_type&quot;: &quot;button&quot;
          }
        },
        &quot;quantity_selector&quot;: {
          &quot;type&quot;: &quot;quantity_selector&quot;,
          &quot;settings&quot;: {
          }
        },
        &quot;buy_buttons&quot;: {
          &quot;type&quot;: &quot;buy_buttons&quot;,
          &quot;settings&quot;: {
            &quot;show_dynamic_checkout&quot;: true
          }
        },
        &quot;description&quot;: {
          &quot;type&quot;: &quot;description&quot;,
          &quot;settings&quot;: {
          }
        },
        &quot;share&quot;: {
          &quot;type&quot;: &quot;share&quot;,
          &quot;settings&quot;: {
            &quot;share_label&quot;: &quot;Share&quot;
          }
        }
      },
      &quot;block_order&quot;: [
        &quot;vendor&quot;,
        &quot;title&quot;,
        &quot;subtitle&quot;,
        &quot;price&quot;,
        &quot;variant_picker&quot;,
        &quot;quantity_selector&quot;,
        &quot;buy_buttons&quot;,
        &quot;description&quot;,
        &quot;share&quot;
      ],
      &quot;settings&quot;: {
        &quot;enable_sticky_info&quot;: true,
        &quot;hide_variants&quot;: false,
        &quot;enable_video_looping&quot;: false
      }
    },
    &quot;product-recommendations&quot;: {
      &quot;type&quot;: &quot;product-recommendations&quot;,
      &quot;settings&quot;: {
        &quot;heading&quot;: &quot;You may also like&quot;,
        &quot;image_ratio&quot;: &quot;adapt&quot;,
        &quot;show_secondary_image&quot;: false,
        &quot;add_image_padding&quot;: false,
        &quot;show_image_outline&quot;: true,
        &quot;show_vendor&quot;: false,
        &quot;show_rating&quot;: false
      }
    },
    &quot;recent-products&quot;: {
      &quot;type&quot;: &quot;recent-products&quot;,
      &quot;settings&quot;: {
      }
    }
  },
  &quot;order&quot;: [
    &quot;main&quot;,
    &quot;product-recommendations&quot;,
    &quot;recent-products&quot;
  ]
}
</code></pre><p>Don&rsquo;t forget to add the section name to the <code>order</code>.</p>
<p>Now you should see in the theme customizer for your product page a section called <code>Recent Products</code>.</p>
<p>If you are using a different theme (most likely one without a <code>product.json</code> template file), you can create a new snippet file (in the <code>Snippets</code> folder), add the same code as for the section <em><strong>without</strong></em> the schema part at the end.</p>
<pre><code>{% schema %}
  {
    &quot;name&quot;: &quot;Recent Products&quot;,
    &quot;settings&quot;: []
  }
{% endschema %}
</code></pre><p>In you <code>product.liquid</code> file (or the sub-file whch contains the full product page code) include the snippet using:</p>
<pre><code>{% render 'recent-products' %}
</code></pre><p>Place it where you would like the recently viewed products to appear on the product page.</p>
</div>
</article></main>
<footer class="footer" role="contentinfo" aria-labelledby="label-footer">
  <h2 id="label-footer" class="sr-only">Page footer</h2>
  <span>&copy; 2022 <a href="https://alanryan.dev">Alan Ryan</a></span>
  <span>&middot;</span>
  <span>Powered by <a href="https://gohugo.io/" rel="noopener" target="_blank">HugoÔ∏èÔ∏è</a>Ô∏è</span>
  <span>&middot;</span>
  <span>Patterns by <a href="https://heropatterns.com/" rel="noopener" target="_blank">HeroÔ∏èÔ∏è Patterns</a>Ô∏è</span>
</footer>
</div>
<script src="https://alanryan.dev/theme-toggle.js"></script>

</body>
</html>


